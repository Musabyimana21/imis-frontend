import{w as s}from"./CJT9dmhh.js";import{e as m}from"./f4Im-s9B.js";const r=localStorage.getItem("token"),u=JSON.parse(localStorage.getItem("user")||"null"),a=s(r),n=s(u),d=s(!!r);a.subscribe(e=>{e?localStorage.setItem("token",e):localStorage.removeItem("token")});n.subscribe(e=>{e?localStorage.setItem("user",JSON.stringify(e)):localStorage.removeItem("user")});async function f(e,c){const i=m.PUBLIC_API_URL||"http://localhost:8000",t=await fetch(`${i}/auth/login`,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({username:e,password:c})});if(!t.ok){const l=await t.json();throw new Error(l.detail||"Login failed")}const o=await t.json();return a.set(o.access_token),n.set(o.user||{email:e}),d.set(!0),o}export{d as i,f as l,a as t};
