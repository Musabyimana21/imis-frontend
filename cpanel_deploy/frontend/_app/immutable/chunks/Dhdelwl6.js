import{s as ke,n as re,d as o,i as G,c as t,e as d,Y as Ce,o as D,j as n,k as p,m as Y,w as Z,q as I,p as i,x as $,X as De,u as Ie,v as ee,a as we,D as Ve,l as ye}from"./CXRviRvy.js";import{e as ce}from"./D6YF6ztN.js";import{S as Ee,i as Me}from"./EwStbUFK.js";import{a as fe}from"./B8HB78On.js";import{t as Le}from"./DttzWN96.js";import{g as Te}from"./4rErrFS-.js";import{i as je}from"./ClPuwlXU.js";function ve(a,e,s){const l=a.slice();return l[5]=e[s],l[7]=s,l}function ue(a){let e,s=a[0].filter(ge).length+"",l;return{c(){e=i("div"),l=$(s),this.h()},l(r){e=n(r,"DIV",{class:!0});var v=p(e);l=Z(v,s),v.forEach(o),this.h()},h(){d(e,"class","absolute -top-2 -right-2 w-8 h-8 bg-gradient-to-r from-red-500 to-orange-500 rounded-full flex items-center justify-center text-white font-black text-sm shadow-lg animate-pulse")},m(r,v){G(r,e,v),t(e,l)},p(r,v){v&1&&s!==(s=r[0].filter(ge).length+"")&&ee(l,s)},d(r){r&&o(e)}}}function He(a){let e,s,l,r,v,u,M="üì®",h,b,L=a[0].length+"",R,F,w,T="Total Messages",K,j,C,P="‚úâÔ∏è",J,U,q=a[0].filter(pe).length+"",S,g,A,O="Unread",V,f,c,x="‚úÖ",k,_,N=a[0].filter(xe).length+"",z,Q,H,ae="Read",X=ce(a[0]),y=[];for(let m=0;m<X.length;m+=1)y[m]=me(ve(a,X,m));return{c(){e=i("div");for(let m=0;m<y.length;m+=1)y[m].c();s=I(),l=i("div"),r=i("div"),v=i("div"),u=i("div"),u.textContent=M,h=I(),b=i("div"),R=$(L),F=I(),w=i("div"),w.textContent=T,K=I(),j=i("div"),C=i("div"),C.textContent=P,J=I(),U=i("div"),S=$(q),g=I(),A=i("div"),A.textContent=O,V=I(),f=i("div"),c=i("div"),c.textContent=x,k=I(),_=i("div"),z=$(N),Q=I(),H=i("div"),H.textContent=ae,this.h()},l(m){e=n(m,"DIV",{class:!0});var B=p(e);for(let ne=0;ne<y.length;ne+=1)y[ne].l(B);B.forEach(o),s=D(m),l=n(m,"DIV",{class:!0});var E=p(l);r=n(E,"DIV",{class:!0});var W=p(r);v=n(W,"DIV",{});var te=p(v);u=n(te,"DIV",{class:!0,"data-svelte-h":!0}),Y(u)!=="svelte-avhq4o"&&(u.textContent=M),h=D(te),b=n(te,"DIV",{class:!0});var ie=p(b);R=Z(ie,L),ie.forEach(o),F=D(te),w=n(te,"DIV",{class:!0,"data-svelte-h":!0}),Y(w)!=="svelte-myrstq"&&(w.textContent=T),te.forEach(o),K=D(W),j=n(W,"DIV",{});var le=p(j);C=n(le,"DIV",{class:!0,"data-svelte-h":!0}),Y(C)!=="svelte-1ra1y0v"&&(C.textContent=P),J=D(le),U=n(le,"DIV",{class:!0});var oe=p(U);S=Z(oe,q),oe.forEach(o),g=D(le),A=n(le,"DIV",{class:!0,"data-svelte-h":!0}),Y(A)!=="svelte-dktqvh"&&(A.textContent=O),le.forEach(o),V=D(W),f=n(W,"DIV",{});var se=p(f);c=n(se,"DIV",{class:!0,"data-svelte-h":!0}),Y(c)!=="svelte-158zx8i"&&(c.textContent=x),k=D(se),_=n(se,"DIV",{class:!0});var de=p(_);z=Z(de,N),de.forEach(o),Q=D(se),H=n(se,"DIV",{class:!0,"data-svelte-h":!0}),Y(H)!=="svelte-1rqoq0k"&&(H.textContent=ae),se.forEach(o),W.forEach(o),E.forEach(o),this.h()},h(){d(e,"class","space-y-4"),d(u,"class","text-4xl mb-2"),d(b,"class","text-3xl font-black text-rwanda-blue"),d(w,"class","text-gray-600 font-semibold"),d(C,"class","text-4xl mb-2"),d(U,"class","text-3xl font-black text-blue-600"),d(A,"class","text-gray-600 font-semibold"),d(c,"class","text-4xl mb-2"),d(_,"class","text-3xl font-black text-green-600"),d(H,"class","text-gray-600 font-semibold"),d(r,"class","grid md:grid-cols-3 gap-6 text-center"),d(l,"class","glass-card mt-8")},m(m,B){G(m,e,B);for(let E=0;E<y.length;E+=1)y[E]&&y[E].m(e,null);G(m,s,B),G(m,l,B),t(l,r),t(r,v),t(v,u),t(v,h),t(v,b),t(b,R),t(v,F),t(v,w),t(r,K),t(r,j),t(j,C),t(j,J),t(j,U),t(U,S),t(j,g),t(j,A),t(r,V),t(r,f),t(f,c),t(f,k),t(f,_),t(_,z),t(f,Q),t(f,H)},p(m,B){if(B&5){X=ce(m[0]);let E;for(E=0;E<X.length;E+=1){const W=ve(m,X,E);y[E]?y[E].p(W,B):(y[E]=me(W),y[E].c(),y[E].m(e,null))}for(;E<y.length;E+=1)y[E].d(1);y.length=X.length}B&1&&L!==(L=m[0].length+"")&&ee(R,L),B&1&&q!==(q=m[0].filter(pe).length+"")&&ee(S,q),B&1&&N!==(N=m[0].filter(xe).length+"")&&ee(z,N)},d(m){m&&(o(e),o(s),o(l)),we(y,m)}}}function qe(a){let e,s='<div class="text-8xl mb-6">üì≠</div> <p class="text-2xl text-gray-700 font-bold mb-4">No messages yet</p> <p class="text-gray-600 mb-8">Start connecting with people to reunite lost items!</p> <a href="/" class="btn-primary inline-block">Browse Items</a>';return{c(){e=i("div"),e.innerHTML=s,this.h()},l(l){e=n(l,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-cfd0ju"&&(e.innerHTML=s),this.h()},h(){d(e,"class","glass-card text-center py-20")},m(l,r){G(l,e,r)},p:re,d(l){l&&o(e)}}}function Pe(a){let e,s='<div class="inline-block w-16 h-16 border-4 border-rwanda-blue border-t-transparent rounded-full animate-spin mb-6"></div> <p class="text-xl text-gray-600 font-medium">Loading messages...</p>';return{c(){e=i("div"),e.innerHTML=s,this.h()},l(l){e=n(l,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-1rpjs1h"&&(e.innerHTML=s),this.h()},h(){d(e,"class","glass-card text-center py-20")},m(l,r){G(l,e,r)},p:re,d(l){l&&o(e)}}}function he(a){let e,s="‚úì Mark as read",l,r;function v(){return a[3](a[5])}return{c(){e=i("button"),e.textContent=s,this.h()},l(u){e=n(u,"BUTTON",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-b50p9r"&&(e.textContent=s),this.h()},h(){d(e,"class","px-4 py-2 bg-gradient-to-r from-rwanda-blue to-blue-600 text-white rounded-xl font-bold text-sm hover:shadow-lg transform hover:-translate-y-0.5 transition-all duration-300")},m(u,M){G(u,e,M),l||(r=ye(e,"click",v),l=!0)},p(u,M){a=u},d(u){u&&o(e),l=!1,r()}}}function _e(a){let e,s=`<span class="w-2 h-2 bg-blue-600 rounded-full animate-pulse"></span>
              New message`;return{c(){e=i("div"),e.innerHTML=s,this.h()},l(l){e=n(l,"DIV",{class:!0,"data-svelte-h":!0}),Y(e)!=="svelte-43mb1t"&&(e.innerHTML=s),this.h()},h(){d(e,"class","mt-3 flex items-center gap-2 text-sm font-bold text-blue-600")},m(l,r){G(l,e,r)},d(l){l&&o(e)}}}function me(a){let e,s,l,r,v=a[5].sender_id===a[5].receiver_id?"üë§":"üë•",u,M,h,b,L=a[5].sender_id===a[5].receiver_id?"You":`User #${a[5].sender_id}`,R,F,w,T,K="üïí",j,C=new Date(a[5].created_at).toLocaleString()+"",P,J,U,q,S,g=a[5].content+"",A,O,V,f,c=!a[5].is_read&&he(a),x=!a[5].is_read&&_e();return{c(){e=i("div"),s=i("div"),l=i("div"),r=i("div"),u=$(v),M=I(),h=i("div"),b=i("p"),R=$(L),F=I(),w=i("p"),T=i("span"),T.textContent=K,j=I(),P=$(C),J=I(),c&&c.c(),U=I(),q=i("div"),S=i("p"),A=$(g),O=I(),x&&x.c(),V=I(),this.h()},l(k){e=n(k,"DIV",{class:!0,style:!0});var _=p(e);s=n(_,"DIV",{class:!0});var N=p(s);l=n(N,"DIV",{class:!0});var z=p(l);r=n(z,"DIV",{class:!0});var Q=p(r);u=Z(Q,v),Q.forEach(o),M=D(z),h=n(z,"DIV",{});var H=p(h);b=n(H,"P",{class:!0});var ae=p(b);R=Z(ae,L),ae.forEach(o),F=D(H),w=n(H,"P",{class:!0});var X=p(w);T=n(X,"SPAN",{"data-svelte-h":!0}),Y(T)!=="svelte-16te4x"&&(T.textContent=K),j=D(X),P=Z(X,C),X.forEach(o),H.forEach(o),z.forEach(o),J=D(N),c&&c.l(N),N.forEach(o),U=D(_),q=n(_,"DIV",{class:!0});var y=p(q);S=n(y,"P",{class:!0});var m=p(S);A=Z(m,g),m.forEach(o),y.forEach(o),O=D(_),x&&x.l(_),V=D(_),_.forEach(o),this.h()},h(){d(r,"class","w-12 h-12 bg-gradient-to-br from-rwanda-blue to-rwanda-green rounded-full flex items-center justify-center text-2xl shadow-lg"),d(b,"class","font-black text-lg text-gray-800"),d(w,"class","text-sm text-gray-500 flex items-center gap-2"),d(l,"class","flex items-center gap-4"),d(s,"class","flex justify-between items-start mb-4"),d(S,"class","text-gray-700 leading-relaxed"),d(q,"class","bg-white/50 rounded-xl p-4 border border-gray-200"),d(e,"class",f="glass-card "+(a[5].is_read?"bg-white/60":"bg-blue-50/80 border-2 border-blue-200")+" hover:scale-[1.02] transition-all duration-300"),Ve(e,"animation","fadeInUp 0.5s ease-out "+a[7]*.05+"s both")},m(k,_){G(k,e,_),t(e,s),t(s,l),t(l,r),t(r,u),t(l,M),t(l,h),t(h,b),t(b,R),t(h,F),t(h,w),t(w,T),t(w,j),t(w,P),t(s,J),c&&c.m(s,null),t(e,U),t(e,q),t(q,S),t(S,A),t(e,O),x&&x.m(e,null),t(e,V)},p(k,_){_&1&&v!==(v=k[5].sender_id===k[5].receiver_id?"üë§":"üë•")&&ee(u,v),_&1&&L!==(L=k[5].sender_id===k[5].receiver_id?"You":`User #${k[5].sender_id}`)&&ee(R,L),_&1&&C!==(C=new Date(k[5].created_at).toLocaleString()+"")&&ee(P,C),k[5].is_read?c&&(c.d(1),c=null):c?c.p(k,_):(c=he(k),c.c(),c.m(s,null)),_&1&&g!==(g=k[5].content+"")&&ee(A,g),k[5].is_read?x&&(x.d(1),x=null):x||(x=_e(),x.c(),x.m(e,V)),_&1&&f!==(f="glass-card "+(k[5].is_read?"bg-white/60":"bg-blue-50/80 border-2 border-blue-200")+" hover:scale-[1.02] transition-all duration-300")&&d(e,"class",f)},d(k){k&&o(e),c&&c.d(),x&&x.d()}}}function Se(a){let e,s,l,r='<div class="absolute top-0 left-0 w-72 h-72 bg-blue-200/20 rounded-full blur-3xl floating"></div> <div class="absolute bottom-0 right-0 w-72 h-72 bg-purple-200/20 rounded-full blur-3xl floating" style="animation-delay: 1s;"></div>',v,u,M,h,b,L,R=Le("nav.messages")+"",F,w,T,K="Your conversations and notifications",j,C,P,J="üí¨",U,q=a[0].filter(be).length>0,S,g=q&&ue(a);function A(f,c){return f[1]?Pe:f[0].length===0?qe:He}let O=A(a),V=O(a);return{c(){e=I(),s=i("div"),l=i("div"),l.innerHTML=r,v=I(),u=i("div"),M=i("div"),h=i("div"),b=i("h1"),L=i("span"),F=$(R),w=I(),T=i("p"),T.textContent=K,j=I(),C=i("div"),P=i("div"),P.textContent=J,U=I(),g&&g.c(),S=I(),V.c(),this.h()},l(f){Ce("svelte-qdxm2s",document.head).forEach(o),e=D(f),s=n(f,"DIV",{class:!0});var x=p(s);l=n(x,"DIV",{class:!0,"data-svelte-h":!0}),Y(l)!=="svelte-1x7ki8g"&&(l.innerHTML=r),v=D(x),u=n(x,"DIV",{class:!0});var k=p(u);M=n(k,"DIV",{class:!0});var _=p(M);h=n(_,"DIV",{});var N=p(h);b=n(N,"H1",{class:!0});var z=p(b);L=n(z,"SPAN",{class:!0});var Q=p(L);F=Z(Q,R),Q.forEach(o),z.forEach(o),w=D(N),T=n(N,"P",{class:!0,"data-svelte-h":!0}),Y(T)!=="svelte-14oojc7"&&(T.textContent=K),N.forEach(o),j=D(_),C=n(_,"DIV",{class:!0});var H=p(C);P=n(H,"DIV",{class:!0,"data-svelte-h":!0}),Y(P)!=="svelte-sj6dad"&&(P.textContent=J),U=D(H),g&&g.l(H),H.forEach(o),_.forEach(o),k.forEach(o),S=D(x),V.l(x),x.forEach(o),this.h()},h(){document.title="Ishakiro - Messages",d(l,"class","absolute inset-0 overflow-hidden pointer-events-none -z-10"),d(L,"class","gradient-text"),d(b,"class","text-5xl font-black mb-2"),d(T,"class","text-xl text-gray-600"),d(P,"class","text-7xl"),d(C,"class","relative"),d(M,"class","flex items-center justify-between"),d(u,"class","glass-card mb-10"),d(s,"class","max-w-4xl mx-auto relative")},m(f,c){G(f,e,c),G(f,s,c),t(s,l),t(s,v),t(s,u),t(u,M),t(M,h),t(h,b),t(b,L),t(L,F),t(h,w),t(h,T),t(M,j),t(M,C),t(C,P),t(C,U),g&&g.m(C,null),t(s,S),V.m(s,null)},p(f,[c]){c&1&&(q=f[0].filter(be).length>0),q?g?g.p(f,c):(g=ue(f),g.c(),g.m(C,null)):g&&(g.d(1),g=null),O===(O=A(f))&&V?V.p(f,c):(V.d(1),V=O(f),V&&(V.c(),V.m(s,null)))},i:re,o:re,d(f){f&&(o(e),o(s)),g&&g.d(),V.d()}}}const be=a=>!a.is_read,ge=a=>!a.is_read,pe=a=>!a.is_read,xe=a=>a.is_read;function Ae(a,e,s){let l;De(a,je,h=>s(4,l=h));let r=[],v=!0;Ie(async()=>{if(!l){Te("/login");return}try{s(0,r=await fe.messages.getAll())}catch(h){console.error("Failed to load messages:",h)}finally{s(1,v=!1)}});async function u(h){try{await fe.messages.markRead(h),s(0,r=r.map(b=>b.id===h?{...b,is_read:!0}:b))}catch(b){console.error("Failed to mark as read:",b)}}return[r,v,u,h=>u(h.id)]}class Oe extends Ee{constructor(e){super(),Me(this,e,Ae,Se,ke,{})}}export{Oe as component};
